{% extends 'shared/admin/layout/layout.html' %}
{% load forms %}

{% block head_ref %}
  {{ form.media.css }}
{% endblock %}

{% block content %}
  {% comment %} <ul>
    {% for user in page_obj.items %}
      <li>{{ user.username }}</li>
    {% endfor %}
  </ul>
  <p dir="ltr">{{ page_obj.pagination_info.as_dict }}</p>
  <hr /> {% endcomment %}

  <div class="row">
    <div class="col-lg-12">
      <div class="card">
        <div class="card-header">
          <h4 class="card-title">Popup Detection Demo</h4>
        </div>
        <div class="card-body">
          <div class="alert alert-info">
            <h5><i class="fas fa-info-circle"></i> Popup Detection Status</h5>
            <p>
              <strong>Mode:</strong>
              {% if is_popup %}
                <span class="badge badge-success">Popup Window</span>
              {% else %}
                <span class="badge badge-primary">Normal Window</span>
              {% endif %}
            </p>
            <p>
              <strong>URL Parameter:</strong> popup_page={{ request.GET.popup_page|default:'not set' }}
            </p>
            <p>
              <strong>Detection Method:</strong> PopupDetectionMixin (Server-side)
            </p>
          </div>

          <div class="row">
            <div class="col-md-6">
              <h6>Test Popup Functionality</h6>
              <button class="btn btn-primary" custom-popup-page custom-popup-page-url="{% url 'core:base:test' %}" custom-popup-page-data="testData"><i class="fas fa-external-link-alt"></i> Open Test Page in Popup</button>
            </div>
            <div class="col-md-6">
              <h6>Current Page</h6>
              <a href="{% url 'core:base:test' %}" class="btn btn-secondary"><i class="fas fa-arrow-right"></i> Open Test Page Normally</a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-lg-12">
      <div class="card">
        <div class="card-header">
          <h4 class="card-title">Form Widgets</h4>
        </div>
        <div class="card-body">
          {% render_form form %}
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block footer_ref %}
  {{ form.media.js }}
  <script>
    let testData = { key: 'value' };
  </script>
{% endblock %}
